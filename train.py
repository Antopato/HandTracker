from sklearn.ensemble import RandomForestClassifier
import joblib
import numpy as np

model = RandomForestClassifier(n_estimators=100)

X = []  # Lista de vectores de landmarks
y = []  # Lista de etiquetas

# Ejemplos de "thumbs up"
thumbs_up_examples = [
    [0.5,0.6,0, 0.52,0.55,0, 0.54,0.5,0, 0.56,0.45,0, 0.58,0.4,0, 
    0.45,0.6,0, 0.46,0.55,0, 0.47,0.5,0, 0.48,0.45,0, 0.5,0.6,0,
    0.51,0.55,0, 0.52,0.5,0, 0.53,0.45,0, 0.55,0.6,0, 0.56,0.55,0,
    0.57,0.5,0, 0.58,0.45,0, 0.6,0.6,0, 0.61,0.55,0, 0.62,0.5,0, 
    0.63,0.45,0],
     
    [0.51,0.61,0, 0.53,0.56,0, 0.55,0.51,0, 0.57,0.46,0, 0.59,0.41,0,
    0.46,0.61,0, 0.47,0.56,0, 0.48,0.51,0, 0.49,0.46,0, 0.51,0.61,0,
    0.52,0.56,0, 0.53,0.51,0, 0.54,0.46,0, 0.56,0.61,0, 0.57,0.56,0,
    0.58,0.51,0, 0.59,0.46,0, 0.61,0.61,0, 0.62,0.56,0, 0.63,0.51,0,
    0.64,0.46,0],  

    [0.49,0.59,0, 0.51,0.54,0, 0.53,0.49,0, 0.55,0.44,0, 0.57,0.39,0,
    0.44,0.59,0, 0.45,0.54,0, 0.46,0.49,0, 0.47,0.44,0, 0.49,0.59,0,
    0.50,0.54,0, 0.51,0.49,0, 0.52,0.44,0, 0.54,0.59,0, 0.55,0.54,0,
    0.56,0.49,0, 0.57,0.44,0, 0.59,0.59,0, 0.60,0.54,0, 0.61,0.49,0,
    0.62,0.44,0] 
]


thumbs_down_examples = [
    [0.5,0.4,0, 0.52,0.45,0, 0.54,0.5,0, 0.56,0.55,0, 0.58,0.6,0,
    0.45,0.4,0, 0.46,0.45,0, 0.47,0.5,0, 0.48,0.55,0, 0.5,0.4,0,
    0.51,0.45,0, 0.52,0.5,0, 0.53,0.55,0, 0.55,0.4,0, 0.56,0.45,0,
    0.57,0.5,0, 0.58,0.55,0, 0.6,0.4,0, 0.61,0.45,0, 0.62,0.5,0, 
    0.63,0.55,0],

    [0.51,0.39,0, 0.53,0.44,0, 0.55,0.49,0, 0.57,0.54,0, 0.59,0.59,0,
    0.46,0.39,0, 0.47,0.44,0, 0.48,0.49,0, 0.49,0.54,0, 0.51,0.39,0,
    0.52,0.44,0, 0.53,0.49,0, 0.54,0.54,0, 0.56,0.39,0, 0.57,0.44,0,
    0.58,0.49,0, 0.59,0.54,0, 0.61,0.39,0, 0.62,0.44,0, 0.63,0.49,0,
    0.64,0.54,0],  

    [0.49,0.38,0, 0.51,0.43,0, 0.53,0.48,0, 0.55,0.53,0, 0.57,0.58,0,
    0.44,0.38,0, 0.45,0.43,0, 0.46,0.48,0, 0.47,0.53,0, 0.49,0.38,0,
    0.50,0.43,0, 0.51,0.48,0, 0.52,0.53,0, 0.54,0.38,0, 0.55,0.43,0,
    0.56,0.48,0, 0.57,0.53,0, 0.59,0.38,0, 0.60,0.43,0, 0.61,0.48,0,
    0.62,0.53,0]  
]

neutral_examples = [
    [0.5,0.5,0, 0.52,0.5,0, 0.54,0.5,0, 0.56,0.5,0, 0.58,0.5,0,
     0.45,0.5,0, 0.46,0.5,0, 0.47,0.5,0, 0.48,0.5,0, 0.5,0.5,0,
     0.51,0.5,0, 0.52,0.5,0, 0.53,0.5,0, 0.55,0.5,0, 0.56,0.5,0,
     0.57,0.5,0, 0.58,0.5,0, 0.6,0.5,0, 0.61,0.5,0, 0.62,0.5,0, 
     0.63,0.5,0],

    [0.49,0.51,0, 0.51,0.51,0, 0.53,0.51,0, 0.55,0.51,0, 0.57,0.51,0,
    0.44,0.51,0, 0.45,0.51,0, 0.46,0.51,0, 0.47,0.51,0, 0.49,0.51,0,
    0.50,0.51,0, 0.51,0.51,0, 0.52,0.51,0, 0.54,0.51,0, 0.55,0.51,0,
    0.56,0.51,0, 0.57,0.51,0, 0.59,0.51,0, 0.60,0.51,0, 0.61,0.51,0,
    0.62,0.51,0,],  

    [0.5,0.5,0, 0.51,0.5,0, 0.52,0.5,0, 0.53,0.5,0, 0.54,0.5,0,
    0.45,0.5,0, 0.46,0.5,0, 0.47,0.5,0, 0.48,0.5,0, 0.49,0.5,0,
    0.50,0.5,0, 0.51,0.5,0, 0.52,0.5,0, 0.53,0.5,0, 0.54,0.5,0,
    0.55,0.5,0, 0.56,0.5,0, 0.57,0.5,0, 0.58,0.5,0, 0.59,0.5,0,
    0.60,0.5,0]  
]


all_examples = thumbs_up_examples + thumbs_down_examples + neutral_examples
lengths = [len(s) for s in all_examples]
if len(set(lengths)) != 1:
    print("Inhomogeneous sample lengths detected in training data:")
    for i, l in enumerate(lengths):
        group = ('up' if i < len(thumbs_up_examples) else 'down' if i < len(thumbs_up_examples) + len(thumbs_down_examples) else 'neutral')
        print(f"  sample {i:02d} (group={group}): length={l}")
    raise ValueError(f"Samples have different lengths: {sorted(set(lengths))}. All samples must have the same number of features.")

X = np.array(all_examples, dtype=np.float32)
y = ["thumb_up"]*3 + ["thumb_down"]*3 + ["neutral"]*3
model.fit(X, y)

joblib.dump(model, "thumb_model.pkl")